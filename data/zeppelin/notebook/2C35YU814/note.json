{
  "paragraphs": [
    {
      "text": "%md\n### Intro\nThis notebook is an example of how to use **Apache Flink** for processing simple data sets. We will take an open airline data set from [stat-computing.org](http://stat-computing.org) and find out who was the most popular carrier during 1998-2000 years. Next we will build a chart that shows flights distribution by months and look how it changes from year to year. We will use Zeppelin `%table` display system to build charts.",
      "user": "anonymous",
      "dateUpdated": "Jan 9, 2017 11:55:42 AM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003eIntro\u003c/h3\u003e\n\u003cp\u003eThis notebook is an example of how to use \u003cstrong\u003eApache Flink\u003c/strong\u003e for processing simple data sets. We will take an open airline data set from \u003ca href\u003d\"http://stat-computing.org\"\u003estat-computing.org\u003c/a\u003e and find out who was the most popular carrier during 1998-2000 years. Next we will build a chart that shows flights distribution by months and look how it changes from year to year. We will use Zeppelin \u003ccode\u003e%table\u003c/code\u003e display system to build charts.\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1483952101049_-1120777567",
      "id": "20170109-115501_192763014",
      "dateCreated": "Jan 9, 2017 11:55:01 AM",
      "dateStarted": "Jan 9, 2017 11:55:42 AM",
      "dateFinished": "Jan 9, 2017 11:55:44 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n### Getting the data\nFirst we need to download and unpack the data. We will get three big data sets with flight details (one pack for each year) and a small one with carriers names. In total we will get for about 1,5 GB of data. To be able to process such amount of data it is recommended to increase `shell.command.timeout.millisecs` value in `%sh` interpreter settings up to several minutes. You can find interpreters configuration by clicking on `Interpreter` in a drop-down menu from the top right corner of the Zeppelin web-ui.",
      "user": "anonymous",
      "dateUpdated": "Jan 9, 2017 11:56:08 AM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/scala",
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003eGetting the data\u003c/h3\u003e\n\u003cp\u003eFirst we need to download and unpack the data. We will get three big data sets with flight details (one pack for each year) and a small one with carriers names. In total we will get for about 1,5 GB of data. To be able to process such amount of data it is recommended to increase \u003ccode\u003eshell.command.timeout.millisecs\u003c/code\u003e value in \u003ccode\u003e%sh\u003c/code\u003e interpreter settings up to several minutes. You can find interpreters configuration by clicking on \u003ccode\u003eInterpreter\u003c/code\u003e in a drop-down menu from the top right corner of the Zeppelin web-ui.\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1483952142017_284386712",
      "id": "20170109-115542_1487437739",
      "dateCreated": "Jan 9, 2017 11:55:42 AM",
      "dateStarted": "Jan 9, 2017 11:56:07 AM",
      "dateFinished": "Jan 9, 2017 11:56:07 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%sh\nyum install -y bzip2\n",
      "user": "anonymous",
      "dateUpdated": "Jul 1, 2017 5:14:29 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "text",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/text"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Loaded plugins: fastestmirror, ovl\nLoading mirror speeds from cached hostfile\n * base: ftp.fau.de\n * epel: mirror.atomki.mta.hu\n * extras: centos.mirrors.as250.net\n * updates: mirror.ratiokontakt.de\nResolving Dependencies\n--\u003e Running transaction check\n---\u003e Package bzip2.x86_64 0:1.0.6-13.el7 will be installed\n--\u003e Finished Dependency Resolution\n\nDependencies Resolved\n\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n Package         Arch             Version                  Repository      Size\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\nInstalling:\n bzip2           x86_64           1.0.6-13.el7             base            52 k\n\nTransaction Summary\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\nInstall  1 Package\n\nTotal download size: 52 k\nInstalled size: 82 k\nDownloading packages:\nRunning transaction check\nRunning transaction test\nTransaction test succeeded\nRunning transaction\nWarning: RPMDB altered outside of yum.\n  Installing : bzip2-1.0.6-13.el7.x86_64                                    1/1 \n  Verifying  : bzip2-1.0.6-13.el7.x86_64                                    1/1 \n\nInstalled:\n  bzip2.x86_64 0:1.0.6-13.el7                                                   \n\nComplete!\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1498857872729_-1820912269",
      "id": "20170630-212432_99689207",
      "dateCreated": "Jun 30, 2017 9:24:32 PM",
      "dateStarted": "Jul 1, 2017 5:14:29 PM",
      "dateFinished": "Jul 1, 2017 5:14:35 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%sh\n\nrm /tmp/flights98.csv.bz2\ncurl -o /tmp/flights98.csv.bz2 \"http://stat-computing.org/dataexpo/2009/1998.csv.bz2\"\nrm /tmp/flights98.csv\nbzip2 -d /tmp/flights98.csv.bz2\nchmod 666 /tmp/flights98.csv",
      "user": "anonymous",
      "dateUpdated": "Jul 1, 2017 5:14:38 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "text",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/text",
        "tableHide": false,
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "rm: cannot remove \u0027/tmp/flights98.csv.bz2\u0027: No such file or directory\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n\r  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r  0 73.1M    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r  0 73.1M    0  172k    0     0    98k      0  0:12:42  0:00:01  0:12:41   98k\r  2 73.1M    2 1559k    0     0   566k      0  0:02:12  0:00:02  0:02:10  566k\r  5 73.1M    5 4476k    0     0  1193k      0  0:01:02  0:00:03  0:00:59 1192k\r 10 73.1M   10 7939k    0     0  1670k      0  0:00:44  0:00:04  0:00:40 1670k\r 15 73.1M   15 11.1M    0     0  1982k      0  0:00:37  0:00:05  0:00:32 2385k\r 19 73.1M   19 14.4M    0     0  2193k      0  0:00:34  0:00:06  0:00:28 2930k\r 24 73.1M   24 17.8M    0     0  2358k      0  0:00:31  0:00:07  0:00:24 3344k\r 28 73.1M   28 21.1M    0     0  2477k      0  0:00:30  0:00:08  0:00:22 3441k\r 33 73.1M   33 24.1M    0     0  2538k      0  0:00:29  0:00:09  0:00:20 3362k\r 36 73.1M   36 26.6M    0     0  2536k      0  0:00:29  0:00:10  0:00:19 3173k\r 38 73.1M   38 27.9M    0     0  2369k      0  0:00:31  0:00:12  0:00:19 2592k\r 39 73.1M   39 28.7M    0     0  2300k      0  0:00:32  0:00:12  0:00:20 2212k\r 42 73.1M   42 31.1M    0     0  2316k      0  0:00:32  0:00:13  0:00:19 2036k\r 45 73.1M   45 33.2M    0     0  2307k      0  0:00:32  0:00:14  0:00:18 1858k\r 48 73.1M   48 35.4M    0     0  2302k      0  0:00:32  0:00:15  0:00:17 1799k\r 50 73.1M   50 36.9M    0     0  2258k      0  0:00:33  0:00:16  0:00:17 1972k\r 53 73.1M   53 38.9M    0     0  2245k      0  0:00:33  0:00:17  0:00:16 2101k\r 56 73.1M   56 41.0M    0     0  2243k      0  0:00:33  0:00:18  0:00:15 2042k\r 59 73.1M   59 43.2M    0     0  2240k      0  0:00:33  0:00:19  0:00:14 2040k\r 62 73.1M   62 45.4M    0     0  2240k      0  0:00:33  0:00:20  0:00:13 2046k\r 64 73.1M   64 47.2M    0     0  2225k      0  0:00:33  0:00:21  0:00:12 2114k\r 67 73.1M   67 49.5M    0     0  2228k      0  0:00:33  0:00:22  0:00:11 2167k\r 70 73.1M   70 51.6M    0     0  2226k      0  0:00:33  0:00:23  0:00:10 2160k\r 73 73.1M   73 53.6M    0     0  2219k      0  0:00:33  0:00:24  0:00:09 2138k\r 77 73.1M   77 56.5M    0     0  2249k      0  0:00:33  0:00:25  0:00:08 2283k\r 81 73.1M   81 59.9M    0     0  2294k      0  0:00:32  0:00:26  0:00:06 2595k\r 86 73.1M   86 63.0M    0     0  2324k      0  0:00:32  0:00:27  0:00:05 2764k\r 90 73.1M   90 65.9M    0     0  2349k      0  0:00:31  0:00:28  0:00:03 2934k\r 94 73.1M   94 69.0M    0     0  2378k      0  0:00:31  0:00:29  0:00:02 3161k\r 98 73.1M   98 72.3M    0     0  2408k      0  0:00:31  0:00:30  0:00:01 3228k\r100 73.1M  100 73.1M    0     0  2416k      0  0:00:30  0:00:30 --:--:-- 3181k\nrm: cannot remove \u0027/tmp/flights98.csv\u0027: No such file or directory\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1483952167547_-566831096",
      "id": "20170109-115607_1634441713",
      "dateCreated": "Jan 9, 2017 11:56:07 AM",
      "dateStarted": "Jul 1, 2017 5:14:38 PM",
      "dateFinished": "Jul 1, 2017 5:15:24 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%sh\nls -l /tmp",
      "user": "anonymous",
      "dateUpdated": "Jul 1, 2017 5:17:56 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "text",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/text"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "total 1688772\ndrwxr-xr-x 2 root root      4096 Jul  1 17:13 blobStore-0b3d0723-6b0d-47ed-a0ec-342a919366a4\ndrwxr-xr-x 2 root root      4096 Jul  1 17:13 blobStore-27309494-798f-484a-91c9-8422fbeb83cb\ndrwxr-xr-x 2 root root      4096 Jul  1 17:16 blobStore-399a18cd-8ece-4819-867e-e71dc25c7bfb\ndrwxr-xr-x 2 root root      4096 Jul  1 17:13 blobStore-552aa409-f52d-47d7-93b9-4126b1faadd8\ndrwxr-xr-x 2 root root      4096 Jul  1 17:16 blobStore-ce85e1d6-c7f5-4314-ba3a-067ebe3bb07f\ndrwxr-xr-x 2 root root      4096 Jul  1 17:14 blobStore-f7e7484b-96ce-43cb-a746-3b90ceebd7c6\n-rw-rw-rw- 1 root root     43758 Jul  1 17:16 carriers.csv\n-rw------- 1 root root 555249664 Jul  1 17:17 flights00.csv\n-rw-r--r-- 1 root root  82537924 Jul  1 17:17 flights00.csv.bz2\n-rw-rw-rw- 1 root root 538432875 Jul  1 17:15 flights98.csv\n-rw-r--r-- 1 root root 552926022 Jul  1 17:17 flights99.csv\n-rw-r--r-- 1 root root         8 Jul  1 17:13 flink--jobmanager.pid\n-rw-r--r-- 1 root root         9 Jul  1 17:13 flink--taskmanager.pid\ndrwxr-xr-x 2 root root      4096 Jul  1 17:16 flink-dist-cache-5343dc82-46c6-4824-9138-add1aeb065be\ndrwxr-xr-x 2 root root      4096 Jul  1 17:13 flink-dist-cache-5e9b973d-5389-4a09-b897-30d1ae0a499c\ndrwxr-xr-x 2 root root      4096 Jul  1 17:13 flink-dist-cache-a3efea6c-c2c8-41e6-99f8-beb586674f81\ndrwxr-xr-x 2 root root      4096 Jul  1 17:13 flink-dist-cache-e4af29cc-c339-4fe3-9f62-acc046d1d4a2\ndrwxr-xr-x 2 root root      4096 Jul  1 17:13 flink-io-2be1a35f-db5f-404c-88d0-ec401f56e3b6\ndrwxr-xr-x 2 root root      4096 Jul  1 17:13 flink-io-6ad47796-63a9-4762-9ab7-a173db88b72a\ndrwxr-xr-x 2 root root      4096 Jul  1 17:13 flink-io-b66cf3d8-94ba-4dd8-b758-11d996d95fce\ndrwxr-xr-x 2 root root      4096 Jul  1 17:16 flink-io-cbfece2d-7fe2-4fd9-8201-11759949bf37\ndrwxr-xr-x 7 root root      4096 Jul  1 17:14 flink-web-b3f6452e-bb64-4014-b5c0-6aba0bbf4472\ndrwxr-xr-x 2 root root      4096 Jul  1 17:13 flink-web-upload-d5a80baf-2ccd-4790-aed1-c945a22c6c15\ndrwxr-xr-x 1 root root      4096 Jul  1 17:16 hsperfdata_root\n-rwx------ 1 root root       836 Jun  5 03:09 ks-script-3_LJly\ndrwxr-xr-x 2 root root      4096 Jul  1 17:16 scala_shell_tmp-f5144229989cac59e6515de249a252cc\n-rw-r--r-- 1 root root      1606 Jul  1 17:17 supervisord.log\n-rw-r--r-- 1 root root         2 Jul  1 17:13 supervisord.pid\n-rw------- 1 root root         0 Jun  5 03:07 yum.log\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1498857989096_-804790424",
      "id": "20170630-212629_61673742",
      "dateCreated": "Jun 30, 2017 9:26:29 PM",
      "dateStarted": "Jul 1, 2017 5:17:56 PM",
      "dateFinished": "Jul 1, 2017 5:17:56 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%sh\n\nrm /tmp/flights99.csv.bz2\ncurl -o /tmp/flights99.csv.bz2 \"http://stat-computing.org/dataexpo/2009/1999.csv.bz2\"\nrm /tmp/flights99.csv\nbzip2 -d /tmp/flights99.csv.bz2\nchmod 666 /tmp/flights99.csv",
      "user": "anonymous",
      "dateUpdated": "Jul 1, 2017 5:16:57 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "text",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/text",
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "INCOMPLETE",
        "msg": [
          {
            "type": "TEXT",
            "data": "rm: cannot remove \u0027/tmp/flights99.csv.bz2\u0027: No such file or directory\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n\r  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r  0 75.7M    0     0    0     0      0      0 --:--:--  0:00:01 --:--:--     0\r  0 75.7M    0  150k    0     0  81772      0  0:16:11  0:00:01  0:16:10 81737\r  2 75.7M    2 1575k    0     0   544k      0  0:02:22  0:00:02  0:02:20  544k\r  5 75.7M    5 4503k    0     0  1162k      0  0:01:06  0:00:03  0:01:03 1161k\r  9 75.7M    9 7324k    0     0  1499k      0  0:00:51  0:00:04  0:00:47 1499k\r 12 75.7M   12 9354k    0     0  1526k      0  0:00:50  0:00:06  0:00:44 1841k\r 14 75.7M   14 11.2M    0     0  1680k      0  0:00:46  0:00:06  0:00:40 2287k\r 16 75.7M   16 12.6M    0     0  1647k      0  0:00:47  0:00:07  0:00:40 2287k\r 18 75.7M   18 14.1M    0     0  1626k      0  0:00:47  0:00:08  0:00:39 1985k\r 20 75.7M   20 15.8M    0     0  1644k      0  0:00:47  0:00:09  0:00:38 1786k\r 23 75.7M   23 17.6M    0     0  1659k      0  0:00:46  0:00:10  0:00:36 1830k\r 25 75.7M   25 19.5M    0     0  1689k      0  0:00:45  0:00:11  0:00:34 1701k\r 27 75.7M   27 21.0M    0     0  1642k      0  0:00:47  0:00:13  0:00:34 1636k\r 30 75.7M   30 22.7M    0     0  1680k      0  0:00:46  0:00:13  0:00:33 1777k\r 32 75.7M   32 24.6M    0     0  1697k      0  0:00:45  0:00:14  0:00:31 1801k\r 35 75.7M   35 26.6M    0     0  1720k      0  0:00:45  0:00:15  0:00:30 1852k\r 37 75.7M   37 28.5M    0     0  1732k      0  0:00:44  0:00:16  0:00:28 1835k\r 39 75.7M   39 29.5M    0     0  1694k      0  0:00:45  0:00:17  0:00:28 1836k\r 41 75.7M   41 31.5M    0     0  1711k      0  0:00:45  0:00:18  0:00:27 1798k\r 44 75.7M   44 33.4M    0     0  1723k      0  0:00:45  0:00:19  0:00:26 1802k\r 46 75.7M   46 35.2M    0     0  1730k      0  0:00:44  0:00:20  0:00:24 1764k\r 49 75.7M   49 37.2M    0     0  1742k      0  0:00:44  0:00:21  0:00:23 1773k\r 51 75.7M   51 39.1M    0     0  1753k      0  0:00:44  0:00:22  0:00:22 1966k\r 54 75.7M   54 41.1M    0     0  1763k      0  0:00:43  0:00:23  0:00:20 1958k\r 56 75.7M   56 43.0M    0     0  1771k      0  0:00:43  0:00:24  0:00:19 1960k\r 59 75.7M   59 44.9M    0     0  1774k      0  0:00:43  0:00:25  0:00:18 1956k\r 61 75.7M   61 46.7M    0     0  1782k      0  0:00:43  0:00:26  0:00:17 1958k\r 64 75.7M   64 48.6M    0     0  1788k      0  0:00:43  0:00:27  0:00:16 1945k\r 66 75.7M   66 50.5M    0     0  1794k      0  0:00:43  0:00:28  0:00:15 1941k\r 69 75.7M   69 52.5M    0     0  1800k      0  0:00:43  0:00:29  0:00:14 1946k\r 71 75.7M   71 54.4M    0     0  1805k      0  0:00:42  0:00:30  0:00:12 1966k\r 74 75.7M   74 56.3M    0     0  1809k      0  0:00:42  0:00:31  0:00:11 1954k\r 76 75.7M   76 58.1M    0     0  1811k      0  0:00:42  0:00:32  0:00:10 1939k\r 79 75.7M   79 60.0M    0     0  1814k      0  0:00:42  0:00:33  0:00:09 1929k\r 81 75.7M   81 61.8M    0     0  1814k      0  0:00:42  0:00:34  0:00:08 1900k\r 83 75.7M   83 63.5M    0     0  1813k      0  0:00:42  0:00:35  0:00:07 1863k\r 86 75.7M   86 65.3M    0     0  1815k      0  0:00:42  0:00:36  0:00:06 1854k\r 88 75.7M   88 67.0M    0     0  1812k      0  0:00:42  0:00:37  0:00:05 1821k\r 90 75.7M   90 68.7M    0     0  1792k      0  0:00:43  0:00:39  0:00:04 1655k\r 92 75.7M   92 70.2M    0     0  1802k      0  0:00:43  0:00:39  0:00:04 1713k\r 94 75.7M   94 71.9M    0     0  1802k      0  0:00:43  0:00:40  0:00:03 1722k\r 96 75.7M   96 73.3M    0     0  1793k      0  0:00:43  0:00:41  0:00:02 1628k\r 98 75.7M   98 74.9M    0     0  1787k      0  0:00:43  0:00:42  0:00:01 1598k\r100 75.7M  100 75.7M    0     0  1786k      0  0:00:43  0:00:43 --:--:-- 1727k\nrm: cannot remove \u0027/tmp/flights99.csv\u0027: No such file or directory\n"
          },
          {
            "type": "TEXT",
            "data": "Paragraph received a SIGTERM\nExitValue: 143"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1483952257873_-1874269156",
      "id": "20170109-115737_1346880844",
      "dateCreated": "Jan 9, 2017 11:57:37 AM",
      "dateStarted": "Jul 1, 2017 5:16:46 PM",
      "dateFinished": "Jul 1, 2017 5:17:50 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%sh\n\nrm /tmp/flights00.csv.bz2\ncurl -o /tmp/flights00.csv.bz2 \"http://stat-computing.org/dataexpo/2009/2000.csv.bz2\"\nrm /tmp/flights00.csv\nbzip2 -d /tmp/flights00.csv.bz2\nchmod 666 /tmp/flights00.csv",
      "user": "anonymous",
      "dateUpdated": "Jul 1, 2017 5:16:59 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "text",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/text",
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "INCOMPLETE",
        "msg": [
          {
            "type": "TEXT",
            "data": "rm: cannot remove \u0027/tmp/flights00.csv.bz2\u0027: No such file or directory\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n\r  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r  0 78.7M    0 14080    0     0  22182      0  1:02:00 --:--:--  1:02:00 22173\r  0 78.7M    0  269k    0     0   182k      0  0:07:22  0:00:01  0:07:21  182k\r  1 78.7M    1  897k    0     0   361k      0  0:03:42  0:00:02  0:03:40  361k\r  2 78.7M    2 1643k    0     0   443k      0  0:03:01  0:00:03  0:02:58  443k\r  4 78.7M    4 3583k    0     0   798k      0  0:01:40  0:00:04  0:01:36  797k\r  5 78.7M    5 4758k    0     0   868k      0  0:01:32  0:00:05  0:01:27  979k\r  7 78.7M    7 5900k    0     0   910k      0  0:01:28  0:00:06  0:01:22 1126k\r  9 78.7M    9 7572k    0     0  1012k      0  0:01:19  0:00:07  0:01:12 1335k\r 11 78.7M   11 8949k    0     0  1055k      0  0:01:16  0:00:08  0:01:08 1530k\r 12 78.7M   12 10.1M    0     0  1097k      0  0:01:13  0:00:09  0:01:04 1366k\r 14 78.7M   14 11.1M    0     0  1059k      0  0:01:16  0:00:10  0:01:06 1257k\r 15 78.7M   15 12.3M    0     0  1102k      0  0:01:13  0:00:11  0:01:02 1348k\r 17 78.7M   17 13.9M    0     0  1140k      0  0:01:10  0:00:12  0:00:58 1330k\r 19 78.7M   19 15.2M    0     0  1159k      0  0:01:09  0:00:13  0:00:56 1337k\r 21 78.7M   21 16.7M    0     0  1183k      0  0:01:08  0:00:14  0:00:54 1347k\r 22 78.7M   22 17.6M    0     0  1170k      0  0:01:08  0:00:15  0:00:53 1424k\r 24 78.7M   24 19.1M    0     0  1185k      0  0:01:07  0:00:16  0:00:51 1379k\r 26 78.7M   26 20.5M    0     0  1206k      0  0:01:06  0:00:17  0:00:49 1371k\r 28 78.7M   28 22.1M    0     0  1226k      0  0:01:05  0:00:18  0:00:47 1406k\r 29 78.7M   29 23.6M    0     0  1240k      0  0:01:04  0:00:19  0:00:45 1406k\r 31 78.7M   31 25.0M    0     0  1251k      0  0:01:04  0:00:20  0:00:44 1502k\r 33 78.7M   33 26.4M    0     0  1261k      0  0:01:03  0:00:21  0:00:42 1511k\r 35 78.7M   35 27.9M    0     0  1272k      0  0:01:03  0:00:22  0:00:41 1502k\r 37 78.7M   37 29.4M    0     0  1283k      0  0:01:02  0:00:23  0:00:39 1492k\r 39 78.7M   39 30.9M    0     0  1295k      0  0:01:02  0:00:24  0:00:38 1506k\r 41 78.7M   41 32.4M    0     0  1304k      0  0:01:01  0:00:25  0:00:36 1523k\r 43 78.7M   43 33.9M    0     0  1311k      0  0:01:01  0:00:26  0:00:35 1528k\r 44 78.7M   44 35.3M    0     0  1318k      0  0:01:01  0:00:27  0:00:34 1528k\r 46 78.7M   46 36.8M    0     0  1325k      0  0:01:00  0:00:28  0:00:32 1523k\r 48 78.7M   48 38.3M    0     0  1332k      0  0:01:00  0:00:29  0:00:31 1516k\r 50 78.7M   50 39.9M    0     0  1340k      0  0:01:00  0:00:30  0:00:30 1523k\r 52 78.7M   52 41.4M    0     0  1347k      0  0:00:59  0:00:31  0:00:28 1536k\r 54 78.7M   54 43.0M    0     0  1356k      0  0:00:59  0:00:32  0:00:27 1563k\r 56 78.7M   56 44.6M    0     0  1366k      0  0:00:58  0:00:33  0:00:25 1601k\r 58 78.7M   58 46.2M    0     0  1372k      0  0:00:58  0:00:34  0:00:24 1606k\r 60 78.7M   60 47.9M    0     0  1383k      0  0:00:58  0:00:35  0:00:23 1641k\r 62 78.7M   62 49.5M    0     0  1390k      0  0:00:57  0:00:36  0:00:21 1661k\r 65 78.7M   65 51.4M    0     0  1404k      0  0:00:57  0:00:37  0:00:20 1720k\r 67 78.7M   67 53.1M    0     0  1413k      0  0:00:57  0:00:38  0:00:19 1729k\r 70 78.7M   70 55.1M    0     0  1430k      0  0:00:56  0:00:39  0:00:17 1828k\r 72 78.7M   72 56.8M    0     0  1439k      0  0:00:56  0:00:40  0:00:16 1838k\r 75 78.7M   75 59.4M    0     0  1467k      0  0:00:54  0:00:41  0:00:13 2033k\r 79 78.7M   79 62.8M    0     0  1515k      0  0:00:53  0:00:42  0:00:11 2340k\r 84 78.7M   84 66.2M    0     0  1559k      0  0:00:51  0:00:43  0:00:08 2685k\r 88 78.7M   88 69.6M    0     0  1602k      0  0:00:50  0:00:44  0:00:06 2965k\r 92 78.7M   92 72.6M    0     0  1634k      0  0:00:49  0:00:45  0:00:04 3214k\r 96 78.7M   96 75.9M    0     0  1672k      0  0:00:48  0:00:46  0:00:02 3365k\r100 78.7M  100 78.7M    0     0  1703k      0  0:00:47  0:00:47 --:--:-- 3365k\nrm: cannot remove \u0027/tmp/flights00.csv\u0027: No such file or directory\n"
          },
          {
            "type": "TEXT",
            "data": "Paragraph received a SIGTERM\nExitValue: 143"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1483952312038_-1315320949",
      "id": "20170109-115832_608069986",
      "dateCreated": "Jan 9, 2017 11:58:32 AM",
      "dateStarted": "Jul 1, 2017 5:16:48 PM",
      "dateFinished": "Jul 1, 2017 5:17:57 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%sh\n\nrm /tmp/carriers.csv\ncurl -o /tmp/carriers.csv \"http://stat-computing.org/dataexpo/2009/carriers.csv\"\nchmod 666 /tmp/carriers.csv",
      "user": "anonymous",
      "dateUpdated": "Jul 1, 2017 5:17:00 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "text",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/text",
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "rm: cannot remove \u0027/tmp/carriers.csv\u0027: No such file or directory\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n\r  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r  0 43758    0     0    0     0      0      0 --:--:--  0:00:01 --:--:--     0\r 19 43758   19  8500    0     0   3938      0  0:00:11  0:00:02  0:00:09  3938\r 80 43758   80 35252    0     0  10586      0  0:00:04  0:00:03  0:00:01 10586\r100 43758  100 43758    0     0  12001      0  0:00:03  0:00:03 --:--:-- 12001\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1483952329229_2136292082",
      "id": "20170109-115849_1794095031",
      "dateCreated": "Jan 9, 2017 11:58:49 AM",
      "dateStarted": "Jul 1, 2017 5:16:50 PM",
      "dateFinished": "Jul 1, 2017 5:16:54 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n### Preparing the data\nThe `flights\u003cYY\u003e.csv` contains various data but we only need the information about the year, the month and the carrier who served the flight. Let\u0027s retrieve this information and create `DataSets`.",
      "user": "anonymous",
      "dateUpdated": "Jan 9, 2017 12:01:51 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003ePreparing the data\u003c/h3\u003e\n\u003cp\u003eThe \u003ccode\u003eflights\u0026lt;YY\u0026gt;.csv\u003c/code\u003e contains various data but we only need the information about the year, the month and the carrier who served the flight. Let\u0026rsquo;s retrieve this information and create \u003ccode\u003eDataSets\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1483952363836_-1769111757",
      "id": "20170109-115923_963126574",
      "dateCreated": "Jan 9, 2017 11:59:23 AM",
      "dateStarted": "Jan 9, 2017 12:01:51 PM",
      "dateFinished": "Jan 9, 2017 12:01:53 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%flink\n\ncase class Flight(year: Int, month: Int, carrierCode: String)\ncase class Carrier(code: String, name: String)\n\nval flights98 \u003d benv.readCsvFile[Flight](\"/tmp/flights98.csv\", ignoreFirstLine \u003d true, includedFields \u003d Array(0, 1, 8))\nval flights99 \u003d benv.readCsvFile[Flight](\"/tmp/flights99.csv\", ignoreFirstLine \u003d true, includedFields \u003d Array(0, 1, 8))\nval flights00 \u003d benv.readCsvFile[Flight](\"/tmp/flights00.csv\", ignoreFirstLine \u003d true, includedFields \u003d Array(0, 1, 8))\nval flights \u003d flights98.union(flights99).union(flights00)\nval carriers \u003d benv.readCsvFile[Carrier](\"/tmp/carriers.csv\", ignoreFirstLine \u003d true, quoteCharacter \u003d \u0027\"\u0027)",
      "user": "anonymous",
      "dateUpdated": "Jul 1, 2017 5:21:09 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/scala",
        "lineNumbers": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "defined class Flight\ndefined class Carrier\nflights98: org.apache.flink.api.scala.DataSet[Flight] \u003d org.apache.flink.api.scala.DataSet@1848cabd\nflights99: org.apache.flink.api.scala.DataSet[Flight] \u003d org.apache.flink.api.scala.DataSet@a793da3\nflights00: org.apache.flink.api.scala.DataSet[Flight] \u003d org.apache.flink.api.scala.DataSet@583fbf26\nflights: org.apache.flink.api.scala.DataSet[Flight] \u003d org.apache.flink.api.scala.DataSet@219b66f\ncarriers: org.apache.flink.api.scala.DataSet[Carrier] \u003d org.apache.flink.api.scala.DataSet@298b7ab1\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1483952511284_-589624871",
      "id": "20170109-120151_872852428",
      "dateCreated": "Jan 9, 2017 12:01:51 PM",
      "dateStarted": "Jul 1, 2017 5:21:09 PM",
      "dateFinished": "Jul 1, 2017 5:21:24 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n### Choosing the carrier\nNow we will search for the most popular carrier during the whole time period.",
      "user": "anonymous",
      "dateUpdated": "Jan 9, 2017 12:03:08 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003eChoosing the carrier\u003c/h3\u003e\n\u003cp\u003eNow we will search for the most popular carrier during the whole time period.\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1483952530113_212237809",
      "id": "20170109-120210_773710997",
      "dateCreated": "Jan 9, 2017 12:02:10 PM",
      "dateStarted": "Jan 9, 2017 12:03:08 PM",
      "dateFinished": "Jan 9, 2017 12:03:08 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%flink\n\nimport org.apache.flink.api.common.operators.Order\nimport org.apache.flink.api.java.aggregation.Aggregations\n\ncase class CarrierFlightsCount(carrierCode: String, count: Int)\ncase class CountByMonth(month: Int, count: Int)\n\nval carriersFlights \u003d flights\n  .map(f \u003d\u003e CarrierFlightsCount(f.carrierCode, 1))\n  .groupBy(\"carrierCode\")\n  .sum(\"count\")\n\nval maxFlights \u003d carriersFlights\n  .aggregate(Aggregations.MAX, \"count\")\n\nval bestCarrier \u003d carriersFlights\n  .join(maxFlights)\n  .where(\"count\")\n  .equalTo(\"count\")\n  .map(_._1)\n  \nval carrierName \u003d bestCarrier\n  .join(carriers)\n  .where(\"carrierCode\")\n  .equalTo(\"code\")\n  .map(_._2.name)\n  .collect\n  .head",
      "user": "anonymous",
      "dateUpdated": "Jul 1, 2017 5:21:36 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/scala",
        "lineNumbers": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "ERROR",
        "msg": [
          {
            "type": "TEXT",
            "data": "import org.apache.flink.api.common.operators.Order\nimport org.apache.flink.api.java.aggregation.Aggregations\ndefined class CarrierFlightsCount\ndefined class CountByMonth\ncarriersFlights: org.apache.flink.api.scala.AggregateDataSet[CarrierFlightsCount] \u003d org.apache.flink.api.scala.AggregateDataSet@50dbd14\nmaxFlights: org.apache.flink.api.scala.AggregateDataSet[CarrierFlightsCount] \u003d org.apache.flink.api.scala.AggregateDataSet@1ed9d907\nbestCarrier: org.apache.flink.api.scala.DataSet[CarrierFlightsCount] \u003d org.apache.flink.api.scala.DataSet@18db9e53\norg.apache.flink.client.program.ProgramInvocationException: The program execution failed: Job execution failed.\n  at org.apache.flink.client.program.ClusterClient.run(ClusterClient.java:409)\n  at org.apache.flink.client.program.StandaloneClusterClient.submitJob(StandaloneClusterClient.java:95)\n  at org.apache.flink.client.program.ClusterClient.run(ClusterClient.java:382)\n  at org.apache.flink.client.program.ClusterClient.run(ClusterClient.java:369)\n  at org.apache.flink.client.program.ClusterClient.run(ClusterClient.java:344)\n  at org.apache.flink.client.RemoteExecutor.executePlanWithJars(RemoteExecutor.java:211)\n  at org.apache.flink.client.RemoteExecutor.executePlan(RemoteExecutor.java:188)\n  at org.apache.flink.api.java.RemoteEnvironment.execute(RemoteEnvironment.java:172)\n  at org.apache.flink.api.java.ExecutionEnvironment.execute(ExecutionEnvironment.java:896)\n  at org.apache.flink.api.scala.ExecutionEnvironment.execute(ExecutionEnvironment.scala:637)\n  at org.apache.flink.api.scala.DataSet.collect(DataSet.scala:547)\n  ... 36 elided\nCaused by: org.apache.flink.runtime.client.JobExecutionException: Job execution failed.\n  at org.apache.flink.runtime.jobmanager.JobManager$$anonfun$handleMessage$1$$anonfun$applyOrElse$7.apply$mcV$sp(JobManager.scala:805)\n  at org.apache.flink.runtime.jobmanager.JobManager$$anonfun$handleMessage$1$$anonfun$applyOrElse$7.apply(JobManager.scala:751)\n  at org.apache.flink.runtime.jobmanager.JobManager$$anonfun$handleMessage$1$$anonfun$applyOrElse$7.apply(JobManager.scala:751)\n  at scala.concurrent.impl.Future$PromiseCompletingRunnable.liftedTree1$1(Future.scala:24)\n  at scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:24)\n  at akka.dispatch.TaskInvocation.run(AbstractDispatcher.scala:41)\n  at akka.dispatch.ForkJoinExecutorConfigurator$AkkaForkJoinTask.exec(AbstractDispatcher.scala:401)\n  at scala.concurrent.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260)\n  at scala.concurrent.forkjoin.ForkJoinPool$WorkQueue.pollAndExecAll(ForkJoinPool.java:1253)\n  at scala.concurrent.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1346)\n  at scala.concurrent.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979)\n  at scala.concurrent.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107)\nCaused by: java.lang.NullPointerException\n  at org.apache.flink.runtime.jobmanager.JobManager$$anonfun$org$apache$flink$runtime$jobmanager$JobManager$$submitJob$1.apply$mcV$sp(JobManager.scala:1332)\n  at org.apache.flink.runtime.jobmanager.JobManager$$anonfun$org$apache$flink$runtime$jobmanager$JobManager$$submitJob$1.apply(JobManager.scala:1327)\n  at org.apache.flink.runtime.jobmanager.JobManager$$anonfun$org$apache$flink$runtime$jobmanager$JobManager$$submitJob$1.apply(JobManager.scala:1327)\n  ... 9 more\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1483952588708_-1770095793",
      "id": "20170109-120308_1328511597",
      "dateCreated": "Jan 9, 2017 12:03:08 PM",
      "dateStarted": "Jul 1, 2017 5:21:36 PM",
      "dateFinished": "Jul 1, 2017 5:21:41 PM",
      "status": "ERROR",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%flink\n\nprintln(s\"\"\"The most popular carrier is:\n$carrierName\n\"\"\")",
      "user": "anonymous",
      "dateUpdated": "Jul 1, 2017 5:19:05 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "text",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/text",
        "lineNumbers": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "The most popular carrier is:\nDelta Air Lines Inc.\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1483952621624_-1222400539",
      "id": "20170109-120341_952212268",
      "dateCreated": "Jan 9, 2017 12:03:41 PM",
      "dateStarted": "Jul 1, 2017 5:19:05 PM",
      "dateFinished": "Jul 1, 2017 5:19:05 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n### Calculating flights\nThe last step is to filter **Delta Air Lines** flights and group them by months.",
      "user": "anonymous",
      "dateUpdated": "Jan 9, 2017 12:04:26 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003eCalculating flights\u003c/h3\u003e\n\u003cp\u003eThe last step is to filter \u003cstrong\u003eDelta Air Lines\u003c/strong\u003e flights and group them by months.\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1483952649646_-1553253944",
      "id": "20170109-120409_2003276881",
      "dateCreated": "Jan 9, 2017 12:04:09 PM",
      "dateStarted": "Jan 9, 2017 12:04:26 PM",
      "dateFinished": "Jan 9, 2017 12:04:26 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "flights grouping",
      "text": "%flink\n\ndef countFlightsPerMonth(flights: DataSet[Flight],\n                         carrier: DataSet[CarrierFlightsCount]) \u003d {\n  val carrierFlights \u003d flights\n    .join(carrier)\n    .where(\"carrierCode\")\n    .equalTo(\"carrierCode\")\n    .map(_._1)\n    \n  carrierFlights\n    .map(flight \u003d\u003e CountByMonth(flight.month, 1))\n    .groupBy(\"month\")\n    .sum(\"count\")\n    .sortPartition(\"month\", Order.ASCENDING)\n}\n\nval bestCarrierFlights_98 \u003d countFlightsPerMonth(flights98, bestCarrier)\nval bestCarrierFlights_99 \u003d countFlightsPerMonth(flights99, bestCarrier)\nval bestCarrierFlights_00 \u003d countFlightsPerMonth(flights00, bestCarrier)",
      "user": "anonymous",
      "dateUpdated": "Jul 1, 2017 5:19:09 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "text",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/text",
        "lineNumbers": true,
        "title": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "countFlightsPerMonth: (flights: org.apache.flink.api.scala.DataSet[Flight], carrier: org.apache.flink.api.scala.DataSet[CarrierFlightsCount])org.apache.flink.api.scala.DataSet[CountByMonth]\nbestCarrierFlights_98: org.apache.flink.api.scala.DataSet[CountByMonth] \u003d org.apache.flink.api.scala.PartitionSortedDataSet@68c9b347\nbestCarrierFlights_99: org.apache.flink.api.scala.DataSet[CountByMonth] \u003d org.apache.flink.api.scala.PartitionSortedDataSet@4424ec72\nbestCarrierFlights_00: org.apache.flink.api.scala.DataSet[CountByMonth] \u003d org.apache.flink.api.scala.PartitionSortedDataSet@69d3c639\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1483952665972_667547355",
      "id": "20170109-120425_2018337048",
      "dateCreated": "Jan 9, 2017 12:04:25 PM",
      "dateStarted": "Jul 1, 2017 5:19:09 PM",
      "dateFinished": "Jul 1, 2017 5:19:11 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "making a results table",
      "text": "%flink\n\ndef monthAsString(month: Int): String \u003d {\n  month match {\n    case 1 \u003d\u003e \"Jan\"\n    case 2 \u003d\u003e \"Feb\"\n    case 3 \u003d\u003e \"Mar\"\n    case 4 \u003d\u003e \"Apr\"\n    case 5 \u003d\u003e \"May\"\n    case 6 \u003d\u003e \"Jun\"\n    case 7 \u003d\u003e \"Jul\"\n    case 8 \u003d\u003e \"Aug\"\n    case 9 \u003d\u003e \"Sept\"\n    case 10 \u003d\u003e \"Oct\"\n    case 11 \u003d\u003e \"Nov\"\n    case 12 \u003d\u003e \"Dec\"\n  }\n}\n\n// We should put all the results into a common DataFrame\n// to show them in a common picture\nval bestCarrierFlights \u003d bestCarrierFlights_98\n  .join(bestCarrierFlights_99)\n  .where(\"month\")\n  .equalTo(\"month\")\n  .map(tuple \u003d\u003e (tuple._1.month, tuple._1.count, tuple._2.count))\n  .join(bestCarrierFlights_00)\n  .where(0)\n  .equalTo(\"month\")\n  .map(tuple \u003d\u003e (tuple._1._1, tuple._1._2, tuple._1._3, tuple._2.count))\n  .collect\n  \nvar flightsByMonthTable \u003d s\"Month\\t1998\\t1999\\t2000\\n\"\nbestCarrierFlights.foreach(data \u003d\u003e flightsByMonthTable +\u003d s\"${monthAsString(data._1)}\\t${data._2}\\t${data._3}\\t${data._4}\\n\")",
      "user": "anonymous",
      "dateUpdated": "Jul 1, 2017 5:19:14 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "text",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/text",
        "lineNumbers": true,
        "title": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "monthAsString: (month: Int)String\nbestCarrierFlights: Seq[(Int, Int, Int, Int)] \u003d Buffer((1,78523,77745,78055), (2,71101,70498,71090), (3,78906,77812,78453), (4,75726,75343,75247), (5,77937,77226,76797), (6,75432,75840,74846), (7,77521,77264,75776), (8,78104,78141,77654), (9,74840,75067,73696), (10,76145,77829,77425), (11,73552,74411,73659), (12,77308,76954,75331))\nflightsByMonthTable: String \u003d\n\"Month\t1998\t1999\t2000\n\"\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1483952690164_-1061667443",
      "id": "20170109-120450_1574916350",
      "dateCreated": "Jan 9, 2017 12:04:50 PM",
      "dateStarted": "Jul 1, 2017 5:19:14 PM",
      "dateFinished": "Jul 1, 2017 5:19:36 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "\"Delta Air Lines\" flights count by months",
      "text": "%flink\n\nprintln(s\"\"\"%table\n$flightsByMonthTable\n\"\"\")",
      "user": "anonymous",
      "dateUpdated": "Jul 1, 2017 5:20:05 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "lineChart",
              "height": 300.0,
              "optionOpen": false,
              "setting": {
                "lineChart": {}
              },
              "commonSetting": {},
              "keys": [
                {
                  "name": "Month",
                  "index": 0.0,
                  "aggr": "sum"
                }
              ],
              "groups": [],
              "values": [
                {
                  "name": "1998",
                  "index": 1.0,
                  "aggr": "sum"
                },
                {
                  "name": "1999",
                  "index": 2.0,
                  "aggr": "sum"
                },
                {
                  "name": "2000",
                  "index": 3.0,
                  "aggr": "sum"
                }
              ]
            },
            "helium": {}
          }
        },
        "editorSetting": {
          "language": "text",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/text",
        "title": true,
        "lineNumbers": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "Month\t1998\t1999\t2000\nJan\t78523\t77745\t78055\nFeb\t71101\t70498\t71090\nMar\t78906\t77812\t78453\nApr\t75726\t75343\t75247\nMay\t77937\t77226\t76797\nJun\t75432\t75840\t74846\nJul\t77521\t77264\t75776\nAug\t78104\t78141\t77654\nSept\t74840\t75067\t73696\nOct\t76145\t77829\t77425\nNov\t73552\t74411\t73659\nDec\t77308\t76954\t75331\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1483952724460_191505697",
      "id": "20170109-120524_2037622815",
      "dateCreated": "Jan 9, 2017 12:05:24 PM",
      "dateStarted": "Jul 1, 2017 5:20:05 PM",
      "dateFinished": "Jul 1, 2017 5:20:06 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n### Results\nLooking at this chart we can say that February is the most unpopular month, but this is only because it has less days (28 or 29) than the other months (30 or 31). To receive more fair picture we should calculate the average flights count per day for each month.",
      "user": "anonymous",
      "dateUpdated": "Jan 9, 2017 12:06:34 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003eResults\u003c/h3\u003e\n\u003cp\u003eLooking at this chart we can say that February is the most unpopular month, but this is only because it has less days (28 or 29) than the other months (30 or 31). To receive more fair picture we should calculate the average flights count per day for each month.\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1483952767719_-1010557136",
      "id": "20170109-120607_67673280",
      "dateCreated": "Jan 9, 2017 12:06:07 PM",
      "dateStarted": "Jan 9, 2017 12:06:34 PM",
      "dateFinished": "Jan 9, 2017 12:06:34 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%flink\n\ndef daysInMonth(month: Int, year: Int): Int \u003d {\n  month match {\n    case 1 \u003d\u003e 31\n    case 2 \u003d\u003e if (year % 4 \u003d\u003d 0) {\n        29\n    } else {\n        28\n    }\n    case 3 \u003d\u003e 31\n    case 4 \u003d\u003e 30\n    case 5 \u003d\u003e 31\n    case 6 \u003d\u003e 30\n    case 7 \u003d\u003e 31\n    case 8 \u003d\u003e 31\n    case 9 \u003d\u003e 30\n    case 10 \u003d\u003e 31\n    case 11 \u003d\u003e 30\n    case 12 \u003d\u003e 31\n  }\n}\n\n\nvar flightsByDayTable \u003d s\"Month\\t1998\\t1999\\t2000\\n\"\n\nbestCarrierFlights.foreach(data \u003d\u003e flightsByDayTable +\u003d s\"${monthAsString(data._1)}\\t${data._2/daysInMonth(data._1,1998)}\\t${data._3/daysInMonth(data._1,1999)}\\t${data._4/daysInMonth(data._1,2000)}\\n\")",
      "user": "anonymous",
      "dateUpdated": "Jul 1, 2017 5:20:09 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "text",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/text",
        "lineNumbers": true,
        "tableHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "daysInMonth: (month: Int, year: Int)Int\nflightsByDayTable: String \u003d\n\"Month\t1998\t1999\t2000\n\"\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1483952794097_-785833130",
      "id": "20170109-120634_492170963",
      "dateCreated": "Jan 9, 2017 12:06:34 PM",
      "dateStarted": "Jul 1, 2017 5:20:09 PM",
      "dateFinished": "Jul 1, 2017 5:20:10 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "\"Delta Air Lines\" flights count by days",
      "text": "%flink\n\nprintln(s\"\"\"%table\n$flightsByDayTable\n\"\"\")",
      "user": "anonymous",
      "dateUpdated": "Jul 1, 2017 5:20:16 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "lineChart",
              "height": 300.0,
              "optionOpen": false,
              "setting": {
                "lineChart": {}
              },
              "commonSetting": {},
              "keys": [
                {
                  "name": "Month",
                  "index": 0.0,
                  "aggr": "sum"
                }
              ],
              "groups": [],
              "values": [
                {
                  "name": "1998",
                  "index": 1.0,
                  "aggr": "sum"
                },
                {
                  "name": "1999",
                  "index": 2.0,
                  "aggr": "sum"
                },
                {
                  "name": "2000",
                  "index": 3.0,
                  "aggr": "sum"
                }
              ]
            },
            "helium": {}
          }
        },
        "editorSetting": {
          "language": "text",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/text",
        "title": true,
        "lineNumbers": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "Month\t1998\t1999\t2000\nJan\t2533\t2507\t2517\nFeb\t2539\t2517\t2451\nMar\t2545\t2510\t2530\nApr\t2524\t2511\t2508\nMay\t2514\t2491\t2477\nJun\t2514\t2528\t2494\nJul\t2500\t2492\t2444\nAug\t2519\t2520\t2504\nSept\t2494\t2502\t2456\nOct\t2456\t2510\t2497\nNov\t2451\t2480\t2455\nDec\t2493\t2482\t2430\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1483952813391_1847418990",
      "id": "20170109-120653_1870236569",
      "dateCreated": "Jan 9, 2017 12:06:53 PM",
      "dateStarted": "Jul 1, 2017 5:20:16 PM",
      "dateFinished": "Jul 1, 2017 5:20:17 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%flink\n",
      "dateUpdated": "Jan 9, 2017 12:07:22 PM",
      "config": {},
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1483952842919_587228425",
      "id": "20170109-120722_939892827",
      "dateCreated": "Jan 9, 2017 12:07:22 PM",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "Zeppelin Tutorial/Using Flink for batch processing",
  "id": "2C35YU814",
  "angularObjects": {
    "2CNRKH563:shared_process": [],
    "2CKHAXX6Z:shared_process": [],
    "2CMAD3QUR:shared_process": [],
    "2CNXX63TN:shared_process": [],
    "2CNBSGWZ8:shared_process": [],
    "2CNGXM993:shared_process": [],
    "2CNHJNR2N:shared_process": [],
    "2CMGPHPZ2:shared_process": [],
    "2CPE1VH7W:shared_process": [],
    "2CK8BZHZJ:shared_process": [],
    "2CKQZCHSK:shared_process": [],
    "2CMZ6ZJ6X:shared_process": [],
    "2CPDVS3WU:shared_process": [],
    "2CP6646VS:shared_process": [],
    "2CKVVRVAE:shared_process": [],
    "2CM5UJRTH:shared_process": [],
    "2CNSGAYTN:shared_process": [],
    "2CMNGWP6W:shared_process": [],
    "2CNPFS97Q:shared_process": []
  },
  "config": {
    "looknfeel": "default"
  },
  "info": {}
}