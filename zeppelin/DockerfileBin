# Base java image
FROM spark:latest

RUN python --version
# Configure spark and mesos
ENV MASTER mesos://spark:5050
ENV MESOS_NATIVE_JAVA_LIBRARY /usr/lib/libmesos.so
ENV SPARK_HOME /usr/local/spark/

# Preconfigure image
ENV ZEPVER 0.7.2

# Download zeppelin
RUN wget -P /tmp http://apache.mirror.anlx.net/zeppelin/zeppelin-0.7.2/zeppelin-$ZEPVER-bin-all.tgz
RUN tar -xzf /tmp/zeppelin-$ZEPVER-bin-all.tgz -C /usr
RUN rm /tmp/zeppelin-$ZEPVER-bin-all.tgz
RUN mv /usr/zeppelin-$ZEPVER-bin-all /usr/zeppelin
RUN ls -l /usr/zeppelin/bin
WORKDIR /usr/zeppelin


# Configure image
#RUN pip3 install --upgrade pip3
#RUN pip3 install --upgrade distribute
RUN python --version
#RUN pip install distribute==0.6.28 functools32  subprocess32
RUN pip install matplotlib seaborn


# Expose default zeppelin port
EXPOSE 8080

# RUN zeppelin
CMD ["/usr/zeppelin/bin/zeppelin.sh"]
